<div class="min-h-screen bg-gray-50 py-8">
  <div class="container mx-auto px-4">
    <!-- Header Section -->
    <div class="text-center mb-12">
      <h1 class="text-4xl font-bold text-gray-900 mb-4">Publications</h1>
      <p class="text-lg text-gray-600 max-w-2xl mx-auto">
        Nazmul Karim Study Center's official journals and research publications
      </p>
      <p class="text-sm text-primary mt-2">
        Found {{filteredPublications.length}} publications
      </p>
    </div>

    <!-- Search and Filter Section -->
    <div class="glass rounded-2xl p-6 mb-8">
      <div class="flex flex-col md:flex-row gap-4 justify-between items-center">
        <!-- Search Box -->
        <div class="flex-1 w-full md:max-w-md">
          <div class="relative">
            <input 
              type="text" 
              placeholder="Search publications..." 
              [(ngModel)]="searchTerm"
              (input)="onSearch(searchTerm)"
              class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
            >
            <i class="pi pi-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
          </div>
        </div>

        <!-- Filter Options -->
        <div class="flex flex-wrap gap-3">
          <select 
            [(ngModel)]="selectedCategory"
            (change)="onCategoryFilter(selectedCategory)"
            class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
            <option value="">All Categories</option>
            <option value="journal">Journal</option>
            <option value="research">Research Paper</option>
            <option value="article">Article</option>
            <option value="biography">Biography</option>
          </select>

          <select 
            [(ngModel)]="selectedYear"
            (change)="onYearFilter(selectedYear)"
            class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
            <option value="">All Years</option>
            <option value="2023">2023</option>
            <option value="2022">2022</option>
            <option value="2021">2021</option>
            <option value="2020">2020</option>
          </select>

          <button 
            (click)="clearFilters()"
            class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">
            <i class="pi pi-times mr-2"></i>
            Clear
          </button>
        </div>
      </div>
    </div>

    <!-- Journal Stats -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
      <div class="glass rounded-xl p-6 text-center">
        <i class="pi pi-book text-3xl text-primary mb-3"></i>
        <div class="text-2xl font-bold text-gray-900">{{publications.length}}</div>
        <div class="text-gray-600">Total Journals</div>
      </div>
      <div class="glass rounded-xl p-6 text-center">
        <i class="pi pi-calendar text-3xl text-green-600 mb-3"></i>
        <div class="text-2xl font-bold text-gray-900">{{getLatestPublicationsCount()}}</div>
        <div class="text-gray-600">Latest (2023)</div>
      </div>
      <div class="glass rounded-xl p-6 text-center">
        <i class="pi pi-tag text-3xl text-purple-600 mb-3"></i>
        <div class="text-2xl font-bold text-gray-900">ISSN 1813-2871</div>
        <div class="text-gray-600">Journal ISSN</div>
      </div>
    </div>

    <!-- Publications Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
      @for (publication of filteredPublications; track publication.id) {
        <div class="glass rounded-2xl p-6 hover-lift transition-all duration-300 group border-2 border-blue-50">
          <!-- Publication Badges -->
          <div class="flex items-start justify-between mb-3">
            <div class="flex flex-wrap gap-2">
              <span [class]="'px-3 py-1 text-sm rounded-full ' + getCategoryColor(publication.category)">
                {{ getCategoryText(publication.category) }}
              </span>
              <span [class]="'px-3 py-1 text-sm rounded-full ' + getJournalBadge(publication.volume)">
                {{ getJournalBadgeText(publication.volume) }}
              </span>
            </div>
            <span class="text-sm font-semibold text-gray-700 bg-gray-100 px-2 py-1 rounded">{{ publication.year }}</span>
          </div>
          
          <!-- Title -->
          <h3 class="text-xl font-bold text-gray-900 mb-3 line-clamp-2">{{ publication.title }}</h3>
          
          <!-- Editor Info -->
          <div class="flex items-start mb-2">
            <i class="pi pi-user mt-1 mr-2 text-primary"></i>
            <div>
              <p class="text-sm text-gray-700 font-medium">Editor: {{ publication.editor }}</p>
              <p class="text-xs text-gray-500">ISSN: {{ publication.issn }}</p>
            </div>
          </div>
          
          <!-- Description -->
          <p class="text-gray-600 text-sm mb-4 line-clamp-3">
            {{ publication.description }}
          </p>
          
          <!-- Journal Details -->
          <div class="space-y-2 mb-4">
            <div class="flex items-center text-xs text-gray-500">
              <i class="pi pi-tag mr-2"></i>
              <span>Volume {{ publication.volume }}, Issue {{ publication.issue }}</span>
            </div>
            <div class="flex items-center text-xs text-gray-500">
              <i class="pi pi-file mr-2"></i>
              <span>{{ publication.pages }} pages • {{ publication.fileSize }}</span>
            </div>
            @if (publication.doi) {
              <div class="flex items-center text-xs text-blue-600">
                <i class="pi pi-external-link mr-2"></i>
                <a [href]="publication.doi" target="_blank" class="hover:underline">{{ publication.doi }}</a>
              </div>
            }
          </div>
          
          <!-- Action Buttons -->
          <div class="flex items-center justify-between pt-4 border-t border-gray-100">
            <div class="flex items-center space-x-3">
              <button 
                (click)="openPdfViewer(publication)"
                class="flex items-center space-x-1 text-primary hover:text-primary-dark transition-colors group/view">
                <i class="pi pi-eye"></i>
                <span class="text-sm">Preview</span>
              </button>
              <button 
                (click)="downloadPdf(publication)"
                class="flex items-center space-x-1 text-green-600 hover:text-green-700 transition-colors group/download">
                <i class="pi pi-download"></i>
                <span class="text-sm">Download</span>
              </button>
            </div>
            <div class="text-right">
              <div class="text-xs text-gray-500">{{ publication.fileType }}</div>
              <div class="text-xs text-gray-400">{{ publication.fileSize }}</div>
            </div>
          </div>
        </div>
      }
    </div>

    <!-- No Results Message -->
    @if (filteredPublications.length === 0) {
      <div class="text-center py-12">
        <i class="pi pi-search text-6xl text-gray-300 mb-4"></i>
        <h3 class="text-xl font-bold text-gray-600 mb-2">No publications found</h3>
        <p class="text-gray-500">Please change your search or filter criteria</p>
        <button 
          (click)="clearFilters()"
          class="mt-4 px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors">
          Clear All Filters
        </button>
      </div>
    }

    <!-- Editorial Board Section -->
    <div class="glass rounded-2xl p-8 mb-12">
      <h2 class="text-2xl font-bold text-gray-900 mb-6 text-center">Journal Editorial Board</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <div class="text-center">
          <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3">
            <i class="pi pi-user text-blue-600 text-xl"></i>
          </div>
          <h4 class="font-semibold text-gray-900">Editor</h4>
          <p class="text-sm text-gray-600">Prof. Dr. A K M Jamal Uddin</p>
          <p class="text-xs text-gray-500">University of Dhaka</p>
        </div>
        <div class="text-center">
          <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3">
            <i class="pi pi-users text-green-600 text-xl"></i>
          </div>
          <h4 class="font-semibold text-gray-900">Editorial Board</h4>
          <p class="text-sm text-gray-600">Prof. Dr. Zeenat Huda</p>
          <p class="text-xs text-gray-500">University of Dhaka</p>
        </div>
        <div class="text-center">
          <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-3">
            <i class="pi pi-users text-purple-600 text-xl"></i>
          </div>
          <h4 class="font-semibold text-gray-900">Editorial Board</h4>
          <p class="text-sm text-gray-600">Prof. Dr. A.S.M. Amanullah</p>
          <p class="text-xs text-gray-500">University of Dhaka</p>
        </div>
        <div class="text-center">
          <div class="w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-3">
            <i class="pi pi-users text-orange-600 text-xl"></i>
          </div>
          <h4 class="font-semibold text-gray-900">Editorial Board</h4>
          <p class="text-sm text-gray-600">Prof. Salma Akhter</p>
          <p class="text-xs text-gray-500">University of Dhaka</p>
        </div>
      </div>
    </div>

    <!-- Contact Information -->
    <div class="glass rounded-2xl p-8 text-center border-2 border-dashed border-gray-300">
      <div class="flex flex-col md:flex-row items-center justify-between gap-6">
        <div class="text-left">
          <h3 class="text-xl font-bold text-gray-900 mb-2">Journal Information</h3>
          <div class="space-y-1">
            <p class="text-gray-600 text-sm flex items-center">
              <i class="pi pi-book mr-2 text-primary"></i>
              ISSN: 1813-2871
            </p>
            <p class="text-gray-600 text-sm flex items-center">
              <i class="pi pi-envelope mr-2 text-primary"></i>
              Email: nksc1511@gmail.com
            </p>
            <p class="text-gray-600 text-sm flex items-center">
              <i class="pi pi-map-marker mr-2 text-primary"></i>
              Nazmul Karim Study Center, University of Dhaka
            </p>
          </div>
        </div>
        
        <div class="flex flex-col sm:flex-row gap-4">
          <button 
            (click)="openPdfViewer(publications[0])"
            class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors inline-flex items-center justify-center">
            <i class="pi pi-eye mr-2"></i>
            View Latest Issue
          </button>
          <a 
            href="mailto:nksc1511@gmail.com"
            class="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors inline-flex items-center justify-center">
            <i class="pi pi-envelope mr-2"></i>
            Contact Editorial
          </a>
        </div>
      </div>
    </div>

    <!-- PDF Viewer Modal - FULL SCREEN IMPROVED VERSION -->
    @if (isPdfViewerOpen && selectedPdf) {
      <div class="fixed inset-0 bg-black/90 z-[9999] flex flex-col">
        <!-- Top Control Bar -->
        <div class="bg-gray-900 text-white px-4 py-3 flex items-center justify-between border-b border-gray-700">
          <div class="flex items-center space-x-4">
            <button 
              (click)="closePdfViewer()"
              class="p-2 hover:bg-gray-800 rounded-lg transition-colors">
              <i class="pi pi-times text-xl"></i>
            </button>
            <div>
              <h3 class="font-semibold truncate max-w-md">{{ selectedPdf.title }}</h3>
              <p class="text-sm text-gray-300">{{ selectedPdf.volume }}, Issue {{ selectedPdf.issue }} • {{ selectedPdf.pages }} pages</p>
            </div>
          </div>
          
          <div class="flex items-center space-x-3">
            <!-- Navigation -->
            <div class="flex items-center space-x-2 bg-gray-800 rounded-lg p-1">
              <button 
                (click)="previousPage()"
                [class]="'p-2 rounded ' + (currentPdfPage === 1 ? 'text-gray-500 cursor-not-allowed' : 'text-white hover:bg-gray-700')"
                [disabled]="currentPdfPage === 1">
                <i class="pi pi-chevron-left"></i>
              </button>
              
              <div class="px-3 py-1 text-sm">
                <span class="text-white">{{ currentPdfPage }}</span>
                <span class="text-gray-400"> / {{ totalPdfPages }}</span>
              </div>
              
              <button 
                (click)="nextPage()"
                [class]="'p-2 rounded ' + (currentPdfPage === totalPdfPages ? 'text-gray-500 cursor-not-allowed' : 'text-white hover:bg-gray-700')"
                [disabled]="currentPdfPage === totalPdfPages">
                <i class="pi pi-chevron-right"></i>
              </button>
            </div>

            <!-- Zoom Controls -->
            <div class="flex items-center space-x-2 bg-gray-800 rounded-lg p-1">
              <button 
                (click)="zoomOut()"
                [class]="'p-2 rounded ' + (zoomLevel <= 0.5 ? 'text-gray-500 cursor-not-allowed' : 'text-white hover:bg-gray-700')"
                [disabled]="zoomLevel <= 0.5">
                <i class="pi pi-search-minus"></i>
              </button>
              
              <div class="px-3 py-1 text-sm text-white min-w-[60px] text-center">
                {{ (zoomLevel * 100).toFixed(0) }}%
              </div>
              
              <button 
                (click)="zoomIn()"
                [class]="'p-2 rounded ' + (zoomLevel >= 2.0 ? 'text-gray-500 cursor-not-allowed' : 'text-white hover:bg-gray-700')"
                [disabled]="zoomLevel >= 2.0">
                <i class="pi pi-search-plus"></i>
              </button>
              
              <button 
                (click)="resetZoom()"
                class="p-2 text-white hover:bg-gray-700 rounded text-sm">
                Reset
              </button>
            </div>

            <!-- Download Button -->
            <button 
              (click)="downloadPdf(selectedPdf)"
              class="ml-2 px-4 py-2 bg-primary hover:bg-primary-dark text-white rounded-lg transition-colors flex items-center space-x-2">
              <i class="pi pi-download"></i>
              <span>Download</span>
            </button>
          </div>
        </div>

        <!-- PDF Container - Full Screen -->
        <div class="flex-1 overflow-hidden">
          @if (isBrowser) {
            <iframe 
              [src]="pdfSrc" 
              class="w-full h-full"
              frameborder="0"
              title="PDF Viewer"
              allow="fullscreen"
              style="background-color: #f5f5f5;">
              <!-- Fallback content -->
              <div class="flex items-center justify-center h-full p-8 bg-gray-900">
                <div class="text-center max-w-md">
                  <i class="pi pi-exclamation-triangle text-5xl text-yellow-500 mb-6"></i>
                  <h3 class="text-xl font-bold text-white mb-4">PDF Viewer Not Available</h3>
                  <p class="text-gray-300 mb-6">Your browser cannot display PDF files inline. Please download the file to view it.</p>
                  <div class="flex flex-col sm:flex-row gap-3 justify-center">
                    <button 
                      (click)="downloadPdf(selectedPdf)"
                      class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors">
                      Download PDF
                    </button>
                    <button 
                      (click)="closePdfViewer()"
                      class="px-6 py-3 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors">
                      Close Viewer
                    </button>
                  </div>
                </div>
              </div>
            </iframe>
          } @else {
            <!-- Server-side fallback -->
            <div class="flex items-center justify-center h-full p-8 bg-gray-900">
              <div class="text-center max-w-md">
                <i class="pi pi-spinner pi-spin text-5xl text-primary mb-6"></i>
                <h3 class="text-xl font-bold text-white mb-4">Loading PDF Viewer</h3>
                <p class="text-gray-300 mb-6">Please wait while we load the PDF viewer...</p>
              </div>
            </div>
          }
        </div>

        <!-- Bottom Info Bar -->
        <div class="bg-gray-900 text-white px-4 py-3 border-t border-gray-700">
          <div class="flex items-center justify-between text-sm">
            <div class="flex items-center space-x-6">
              <span class="text-gray-300">
                <i class="pi pi-file mr-2"></i>
                {{ selectedPdf.fileSize }}
              </span>
              <span class="text-gray-300">
                <i class="pi pi-calendar mr-2"></i>
                {{ selectedPdf.year }}
              </span>
              <span class="text-gray-300">
                <i class="pi pi-user mr-2"></i>
                {{ selectedPdf.editor }}
              </span>
            </div>
            <div class="flex items-center space-x-4">
              <button 
                (click)="openFullscreen()"
                class="text-gray-300 hover:text-white transition-colors flex items-center space-x-2">
                <i class="pi pi-window-maximize"></i>
                <span>Fullscreen</span>
              </button>
              <a 
                [href]="selectedPdf.doi" 
                target="_blank"
                class="text-blue-400 hover:text-blue-300 transition-colors flex items-center space-x-2">
                <i class="pi pi-external-link"></i>
                <span>DOI Link</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    }
  </div>
</div>